# 测试清单

## 功能测试步骤

### 1. 编译和安装
```bash
# 同步Gradle
./gradlew clean

# 编译并安装到设备
./gradlew installDebug
```

### 2. 启动应用
- 在设备/模拟器上找到"Aidl"应用图标
- 点击启动

### 3. 验证跨进程通信

#### 测试1：绑定服务
- [ ] 点击"绑定服务"按钮
- [ ] 观察状态变为"服务已连接"
- [ ] 日志显示"✓ 服务连接成功"
- [ ] Toast提示"服务绑定成功"

#### 测试2：获取进程PID
- [ ] 点击"获取服务进程PID"按钮
- [ ] 日志显示：
  ```
  ⚡ getPid() 调用成功
    客户端 PID: XXXX
    服务端 PID: YYYY
    ✓ 跨进程通信成功！
  ```
- [ ] 验证客户端PID ≠ 服务端PID

#### 测试3：加法运算
- [ ] 点击"测试加法 (5 + 3)"按钮
- [ ] 日志显示：`⚡ add(5, 3) = 8`
- [ ] Toast显示"结果: 8"

#### 测试4：获取服务名称
- [ ] 点击"获取服务名称"按钮
- [ ] 日志显示服务名称和PID
- [ ] Toast显示服务信息

#### 测试5：基本类型传递
- [ ] 点击"测试基本类型传递"按钮
- [ ] 日志显示所有参数
- [ ] Toast提示"基本类型传递成功"

#### 测试6：解绑服务
- [ ] 点击"解绑服务"按钮
- [ ] 状态变为"未连接"
- [ ] 功能按钮变为禁用状态
- [ ] Toast提示"服务已解绑"

### 4. adb命令验证

#### 查看进程列表
```bash
adb shell ps | grep com.zhongmin.aidl
```

**预期输出**：
```
u0_a123   12345  456  ...  com.zhongmin.aidl
u0_a123   12346  456  ...  com.zhongmin.aidl:remote
```

#### 查看日志
```bash
adb logcat -s MainActivity:D RemoteService:D
```

**预期输出示例**：
```
D/MainActivity: onServiceConnected: ComponentInfo{...}
D/RemoteService: RemoteService onCreate, PID: 12346
D/RemoteService: RemoteService onBind
D/RemoteService: add called: 5 + 3 = 8
```

#### 查看Binder线程
```bash
adb shell cat /proc/<服务端PID>/task/*/comm
```

**预期输出**（包含Binder线程）：
```
m.zhongmin.aidl
Binder:12346_1
Binder:12346_2
```

### 5. 错误场景测试

#### 未绑定服务就调用
- [ ] 启动应用后直接点击功能按钮
- [ ] 按钮应该是禁用状态

#### 重复绑定
- [ ] 绑定服务后再次点击"绑定服务"
- [ ] 应该正常处理（已绑定则不重复绑定）

#### 服务崩溃恢复
- [ ] 绑定服务后，通过adb kill服务进程
- [ ] 观察`onServiceDisconnected`回调
- [ ] 重新绑定应该成功

### 6. 内存泄漏检测

#### 旋转屏幕测试
- [ ] 绑定服务
- [ ] 旋转屏幕
- [ ] 检查服务是否正常重连
- [ ] 检查没有重复绑定

#### 应用切换测试
- [ ] 绑定服务
- [ ] 切换到其他应用
- [ ] 返回本应用
- [ ] 服务连接应该正常

#### 退出应用测试
- [ ] 绑定服务
- [ ] 按返回键退出应用
- [ ] 检查`onDestroy`是否调用
- [ ] 检查服务是否解绑

## 性能测试

### 1. 响应时间
- [ ] 测量`add()`方法的调用时间
- [ ] 应该在1-10ms范围内

### 2. 连续调用
- [ ] 连续点击"测试加法"100次
- [ ] 观察是否有异常
- [ ] 检查内存使用情况

### 3. 大量数据传输
- [ ] 调用`basicTypes()`传递大字符串
- [ ] 观察是否有TransactionTooLargeException

## 代码检查

### 1. 编译检查
```bash
./gradlew assembleDebug
```
- [ ] 无编译错误
- [ ] 无警告信息

### 2. 静态代码分析
```bash
./gradlew lint
```
- [ ] 检查lint报告

### 3. 代码格式
- [ ] Java代码缩进正确
- [ ] 注释清晰完整
- [ ] 命名规范

## 兼容性测试

### Android版本
- [ ] Android 14 (API 34)
- [ ] Android 15 (API 35)
- [ ] Android 16 (API 36) - 目标版本

### 设备类型
- [ ] 手机
- [ ] 平板
- [ ] 模拟器

## 文档检查

- [ ] README.md 完整
- [ ] BINDER_MECHANISM.md 详细
- [ ] 代码注释充分
- [ ] 示例清晰

## 问题记录

在测试过程中发现的问题：

| 问题编号 | 问题描述 | 重现步骤 | 解决方案 | 状态 |
|---------|---------|---------|---------|------|
| 1       |         |         |         |      |
| 2       |         |         |         |      |

## 测试结论

- [ ] 所有功能测试通过
- [ ] 跨进程通信正常
- [ ] 无内存泄漏
- [ ] 性能满足要求
- [ ] 文档完整

**测试人员**: _____________

**测试日期**: _____________

**总体评价**: _____________
