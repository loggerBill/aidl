# ä»£ç†å…³ç³»è¯¦è§£ - è°ä»£ç†è°ï¼Ÿ

## ğŸ¯ æ ¸å¿ƒç­”æ¡ˆ

**MyAidlProxy ä»£ç†äº† RemoteService**

- **çœŸå®å¯¹è±¡**ï¼šRemoteServiceï¼ˆåœ¨è¿œç¨‹è¿›ç¨‹ä¸­ï¼ŒçœŸæ­£æ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼‰
- **ä»£ç†å¯¹è±¡**ï¼šMyAidlProxyï¼ˆåœ¨å®¢æˆ·ç«¯è¿›ç¨‹ä¸­ï¼Œå‡è£…è‡ªå·±å°±æ˜¯ RemoteServiceï¼‰
- **å®¢æˆ·ç«¯**ï¼šMainActivityï¼ˆè°ƒç”¨è€…ï¼Œä¸çŸ¥é“ä»£ç†çš„å­˜åœ¨ï¼‰

---

## ğŸ“Š å®Œæ•´è°ƒç”¨é“¾è·¯å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å®¢æˆ·ç«¯è¿›ç¨‹ï¼ˆPID: 12345ï¼‰                       â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                   â”‚
â”‚  â”‚ MainActivity â”‚  æˆ‘è¦è°ƒç”¨ add(5, 3)                                â”‚
â”‚  â”‚  ï¼ˆè°ƒç”¨è€…ï¼‰   â”‚                                                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                                   â”‚
â”‚         â”‚                                                            â”‚
â”‚         â”‚ 1. è°ƒç”¨æ¥å£æ–¹æ³•                                            â”‚
â”‚         â”‚    mService.add(5, 3)                                     â”‚
â”‚         â†“                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                   â”‚
â”‚  â”‚IMyAidlInterfaceâ”‚  è¿™æ˜¯ä¸ªæ¥å£ï¼ŒæŒ‡å‘è°ï¼Ÿ                            â”‚
â”‚  â”‚   (æ¥å£)      â”‚                                                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                  â”‚
â”‚         â”‚                                                            â”‚
â”‚         â”‚ å®é™…æŒ‡å‘ â†“                                                 â”‚
â”‚         â”‚                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                                                  â”‚
â”‚  â”‚ MyAidlProxy   â”‚  â­ ä»£ç†å¯¹è±¡ï¼ˆå‡è£…è‡ªå·±æ˜¯ RemoteServiceï¼‰           â”‚
â”‚  â”‚  ï¼ˆä»£ç†è€…ï¼‰    â”‚                                                  â”‚
â”‚  â”‚               â”‚  æˆ‘ä¸ä¼šçœŸæ­£æ‰§è¡Œ addï¼Œ                              â”‚
â”‚  â”‚  - mRemote    â”‚  æˆ‘åªæ˜¯æŠŠè¯·æ±‚è½¬å‘ç»™çœŸå®å¯¹è±¡ï¼                      â”‚
â”‚  â”‚  - add()      â”‚                                                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                  â”‚
â”‚         â”‚                                                            â”‚
â”‚         â”‚ 2. å°è£…è¯·æ±‚å¹¶å‘é€                                          â”‚
â”‚         â”‚    data.writeInt(5)                                       â”‚
â”‚         â”‚    data.writeInt(3)                                       â”‚
â”‚         â”‚    mRemote.transact(...)                                  â”‚
â”‚         â†“                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ 3. è·¨è¿›ç¨‹è°ƒç”¨ï¼ˆé€šè¿‡ Binder é©±åŠ¨ï¼‰
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         â”‚              æœåŠ¡ç«¯è¿›ç¨‹ï¼ˆPID: 12346ï¼‰                        â”‚
â”‚         â†“                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                   â”‚
â”‚  â”‚  MyAidlStub  â”‚  æ”¶åˆ°è¯·æ±‚ï¼Œè§£æå‚æ•°                                â”‚
â”‚  â”‚ onTransact() â”‚                                                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                                   â”‚
â”‚         â”‚                                                            â”‚
â”‚         â”‚ 4. è°ƒç”¨çœŸå®å®ç°                                             â”‚
â”‚         â†“                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                   â”‚
â”‚  â”‚RemoteService â”‚  â­ çœŸå®å¯¹è±¡ï¼ˆçœŸæ­£å¹²æ´»çš„ï¼‰                          â”‚
â”‚  â”‚ ï¼ˆè¢«ä»£ç†è€…ï¼‰  â”‚                                                   â”‚
â”‚  â”‚              â”‚  çœŸæ­£æ‰§è¡Œï¼šreturn 5 + 3;                           â”‚
â”‚  â”‚  add(5, 3)   â”‚                                                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                                   â”‚
â”‚         â”‚                                                            â”‚
â”‚         â”‚ 5. è¿”å›ç»“æœï¼š8                                             â”‚
â”‚         â†“                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ 6. è·¨è¿›ç¨‹è¿”å›ï¼ˆé€šè¿‡ Binder é©±åŠ¨ï¼‰
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         â”‚              å®¢æˆ·ç«¯è¿›ç¨‹ï¼ˆPID: 12345ï¼‰                        â”‚
â”‚         â†“                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                   â”‚
â”‚  â”‚ MyAidlProxy  â”‚  æ”¶åˆ°è¿”å›å€¼ï¼š8                                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                                   â”‚
â”‚         â”‚                                                            â”‚
â”‚         â”‚ 7. è¿”å›ç»™è°ƒç”¨è€…                                             â”‚
â”‚         â†“                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                   â”‚
â”‚  â”‚ MainActivity â”‚  å¾—åˆ°ç»“æœï¼š8                                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” ä»£ç å±‚é¢è¯¦è§£

### 1ï¸âƒ£ å®¢æˆ·ç«¯ï¼ˆMainActivityï¼‰- è°ƒç”¨è€…

```java
public class MainActivity extends AppCompatActivity {
    // æŒæœ‰çš„æ˜¯æ¥å£å¼•ç”¨
    private IMyAidlInterface mService;
    
    private ServiceConnection mConnection = new ServiceConnection() {
        @Override
        public void onServiceConnected(ComponentName name, IBinder service) {
            // â­ å…³é”®ï¼šè¿™é‡Œè·å¾—çš„æ˜¯ä»£ç†å¯¹è±¡
            mService = MyAidlStub.asInterface(service);
            // mService å®é™…ä¸Šæ˜¯ MyAidlProxy çš„å®ä¾‹ï¼
            
            // MainActivity ä¸çŸ¥é“ mService æ˜¯ä»£ç†
            // å®ƒä»¥ä¸º mService å°±æ˜¯ RemoteService
        }
    };
    
    private void testAdd() {
        try {
            // è°ƒç”¨æ¥å£æ–¹æ³•
            // MainActivity ä»¥ä¸ºåœ¨è°ƒç”¨ RemoteService.add()
            // å®é™…ä¸Šè°ƒç”¨çš„æ˜¯ MyAidlProxy.add()
            int result = mService.add(5, 3);
            
            // MainActivity å®Œå…¨ä¸çŸ¥é“ä¸­é—´ç»è¿‡äº†ä»£ç†ï¼
            Log.d(TAG, "ç»“æœ: " + result);
            
        } catch (RemoteException e) {
            e.printStackTrace();
        }
    }
}
```

**MainActivity çš„è§†è§’**ï¼š
```
æˆ‘è°ƒç”¨ mService.add(5, 3)
â†“
æˆ‘ä»¥ä¸ºç›´æ¥è°ƒç”¨äº† RemoteService
â†“
å®é™…ä¸Šè°ƒç”¨çš„æ˜¯ MyAidlProxyï¼ˆä½†æˆ‘ä¸çŸ¥é“ï¼‰
```

---

### 2ï¸âƒ£ ä»£ç†å¯¹è±¡ï¼ˆMyAidlProxyï¼‰- ä¸­é—´äºº

```java
public class MyAidlProxy implements IMyAidlInterface {
    
    private IBinder mRemote;  // æŒ‡å‘è¿œç¨‹ Binder å¯¹è±¡
    
    public MyAidlProxy(IBinder remote) {
        mRemote = remote;
    }
    
    /**
     * â­ ä»£ç†æ–¹æ³•ï¼šå‡è£…è‡ªå·±åœ¨æ‰§è¡Œ add
     * å®é™…ä¸Šæ˜¯æŠŠè¯·æ±‚è½¬å‘ç»™è¿œç¨‹çš„ RemoteService
     */
    @Override
    public int add(int a, int b) throws RemoteException {
        // æˆ‘ä¸ä¼šçœŸæ­£è®¡ç®— 5 + 3
        // æˆ‘åªæ˜¯ä¸ªä¼ è¯ç­’ï¼ˆä»£ç†ï¼‰
        
        Parcel data = Parcel.obtain();
        Parcel reply = Parcel.obtain();
        int result;
        
        try {
            // 1. æŠŠå‚æ•°æ‰“åŒ…
            data.writeInterfaceToken(DESCRIPTOR);
            data.writeInt(a);      // å‚æ•°1: 5
            data.writeInt(b);      // å‚æ•°2: 3
            
            // 2. å‘é€ç»™è¿œç¨‹çš„çœŸå®å¯¹è±¡ï¼ˆRemoteServiceï¼‰
            // è¿™é‡Œçš„ mRemote è¿æ¥åˆ° RemoteService è¿›ç¨‹
            mRemote.transact(TRANSACTION_add, data, reply, 0);
            
            // 3. æ”¶åˆ°è¿œç¨‹è¿”å›çš„ç»“æœ
            reply.readException();
            result = reply.readInt();  // ç»“æœ: 8
            
        } finally {
            reply.recycle();
            data.recycle();
        }
        
        // 4. æŠŠç»“æœè¿”å›ç»™ MainActivity
        return result;
    }
}
```

**MyAidlProxy çš„èŒè´£**ï¼š
```
1. æ¥æ”¶ MainActivity çš„è°ƒç”¨
2. æŠŠå‚æ•°åºåˆ—åŒ–ï¼ˆæ‰“åŒ…ï¼‰
3. é€šè¿‡ Binder å‘é€ç»™ RemoteService
4. æ¥æ”¶ RemoteService çš„è¿”å›å€¼
5. æŠŠè¿”å›å€¼äº¤ç»™ MainActivity
```

**MyAidlProxy å°±åƒå¤–å–å°å“¥**ï¼š
- ä¸ä¼šåšé¥­ï¼ˆä¸æ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼‰
- åªè´Ÿè´£é€é¤ï¼ˆä¼ é€’è°ƒç”¨ï¼‰

---

### 3ï¸âƒ£ çœŸå®å¯¹è±¡ï¼ˆRemoteServiceï¼‰- å®é™…æ‰§è¡Œè€…

```java
public class RemoteService extends Service {
    
    /**
     * â­ çœŸå®å¯¹è±¡ï¼šçœŸæ­£æ‰§è¡Œä¸šåŠ¡é€»è¾‘
     */
    private final MyAidlStub mBinder = new MyAidlStub() {
        
        @Override
        public int add(int a, int b) throws RemoteException {
            // è¿™é‡Œæ‰æ˜¯çœŸæ­£æ‰§è¡ŒåŠ æ³•çš„åœ°æ–¹ï¼
            int result = a + b;
            
            Log.d(TAG, "RemoteService çœŸæ­£æ‰§è¡Œ: " + a + " + " + b + " = " + result);
            
            return result;
        }
    };
    
    @Override
    public IBinder onBind(Intent intent) {
        // è¿”å›çœŸå®å¯¹è±¡çš„ Binder
        return mBinder;
    }
}
```

**RemoteService çš„èŒè´£**ï¼š
- çœŸæ­£æ‰§è¡Œ `5 + 3 = 8`
- æ˜¯è¢«ä»£ç†çš„å¯¹è±¡

---

## ğŸ­ ä»£ç†æ¨¡å¼çš„æœ¬è´¨

### ä¸ºä»€ä¹ˆéœ€è¦ä»£ç†ï¼Ÿ

å› ä¸ºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯åœ¨**ä¸åŒçš„è¿›ç¨‹**ä¸­ï¼š

```
è¿›ç¨‹ Aï¼ˆå®¢æˆ·ç«¯ï¼‰          è¿›ç¨‹ Bï¼ˆæœåŠ¡ç«¯ï¼‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MainActivity â”‚        â”‚RemoteService â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†‘                        â†‘
       â”‚                        â”‚
   ä¸èƒ½ç›´æ¥è°ƒç”¨ï¼              çœŸå®å¯¹è±¡
   ï¼ˆä¸åŒçš„å†…å­˜ç©ºé—´ï¼‰
```

**é—®é¢˜**ï¼šMainActivity ä¸èƒ½ç›´æ¥è°ƒç”¨ RemoteServiceï¼ˆä¸åŒè¿›ç¨‹ï¼‰

**è§£å†³**ï¼šåœ¨ MainActivity è¿™è¾¹åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ï¼ˆMyAidlProxyï¼‰

```
è¿›ç¨‹ Aï¼ˆå®¢æˆ·ç«¯ï¼‰                    è¿›ç¨‹ Bï¼ˆæœåŠ¡ç«¯ï¼‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MainActivity â”‚                  â”‚RemoteService â”‚
â”‚      â†“       â”‚                  â”‚              â”‚
â”‚ MyAidlProxy  â”‚ â”€â”€â”€ Binder â”€â”€â”€>  â”‚   çœŸå®å¯¹è±¡   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ å®Œæ•´è°ƒç”¨æµç¨‹

### ä»£ç ç¤ºä¾‹

```java
// ã€å®¢æˆ·ç«¯ã€‘MainActivity.java
public void testAdd() {
    // æ­¥éª¤1: MainActivity è°ƒç”¨æ¥å£æ–¹æ³•
    int result = mService.add(5, 3);
    //           â†“
    //    å®é™…è°ƒç”¨çš„æ˜¯ MyAidlProxy.add(5, 3)
}

// ã€ä»£ç†ã€‘MyAidlProxy.java
@Override
public int add(int a, int b) throws RemoteException {
    // æ­¥éª¤2: ä»£ç†æ”¶åˆ°è°ƒç”¨
    Parcel data = Parcel.obtain();
    Parcel reply = Parcel.obtain();
    
    // æ­¥éª¤3: æ‰“åŒ…å‚æ•°
    data.writeInt(5);
    data.writeInt(3);
    
    // æ­¥éª¤4: å‘é€ç»™è¿œç¨‹ï¼ˆé€šè¿‡ Binderï¼‰
    mRemote.transact(TRANSACTION_add, data, reply, 0);
    //       â†“
    // Binder é©±åŠ¨ä¼ é€’åˆ°æœåŠ¡ç«¯è¿›ç¨‹
    
    // æ­¥éª¤7: æ”¶åˆ°è¿”å›å€¼
    int result = reply.readInt();  // 8
    
    // æ­¥éª¤8: è¿”å›ç»™ MainActivity
    return result;
}

// ã€æœåŠ¡ç«¯ã€‘MyAidlStub.java
@Override
protected boolean onTransact(int code, Parcel data, Parcel reply, int flags) {
    switch (code) {
        case TRANSACTION_add:
            // æ­¥éª¤5: è§£æå‚æ•°
            int arg0 = data.readInt();  // 5
            int arg1 = data.readInt();  // 3
            
            // æ­¥éª¤6: è°ƒç”¨çœŸå®å¯¹è±¡çš„æ–¹æ³•
            int result = this.add(arg0, arg1);
            //                â†“
            //    è°ƒç”¨ RemoteService ä¸­çš„å®ç°
            
            // æ­¥éª¤6.5: å†™å…¥è¿”å›å€¼
            reply.writeInt(result);  // 8
            return true;
    }
}

// ã€çœŸå®å¯¹è±¡ã€‘RemoteService.java
@Override
public int add(int a, int b) {
    // æ­¥éª¤6: çœŸæ­£æ‰§è¡Œä¸šåŠ¡é€»è¾‘
    return a + b;  // 5 + 3 = 8
}
```

---

## ğŸ“ å…³é”®ç‚¹æ€»ç»“

### è°æ˜¯è°ï¼Ÿ

| è§’è‰² | ç±»å | ä½ç½® | èŒè´£ |
|------|------|------|------|
| **è°ƒç”¨è€…** | MainActivity | å®¢æˆ·ç«¯è¿›ç¨‹ | å‘èµ·è°ƒç”¨ |
| **ä»£ç†è€…** | MyAidlProxy | å®¢æˆ·ç«¯è¿›ç¨‹ | å‡è£…æ˜¯çœŸå®å¯¹è±¡ï¼Œè½¬å‘è¯·æ±‚ |
| **è¢«ä»£ç†è€…** | RemoteService | æœåŠ¡ç«¯è¿›ç¨‹ | çœŸæ­£æ‰§è¡Œä¸šåŠ¡é€»è¾‘ |

### ä»£ç†å…³ç³»

```
MyAidlProxyï¼ˆä»£ç†ï¼‰
    â†“ ä»£ç†
RemoteServiceï¼ˆçœŸå®å¯¹è±¡ï¼‰
```

**å«ä¹‰**ï¼š
- MyAidlProxy **å‡è£…**è‡ªå·±æ˜¯ RemoteService
- MainActivity ä»¥ä¸ºåœ¨è°ƒç”¨ RemoteService
- å®é™…ä¸Šè°ƒç”¨çš„æ˜¯ MyAidlProxy
- MyAidlProxy å†æŠŠè¯·æ±‚è½¬å‘ç»™çœŸå®çš„ RemoteService

---

## ğŸ’¡ ç”Ÿæ´»ç±»æ¯”

### ç±»æ¯”1ï¼šæ˜æ˜Ÿå’Œç»çºªäºº

```
ç²‰ä¸ï¼ˆMainActivityï¼‰
  â†“ æƒ³è§æ˜æ˜Ÿ
ç»çºªäººï¼ˆMyAidlProxyï¼‰
  â†“ è½¬è¾¾è¯·æ±‚
æ˜æ˜Ÿï¼ˆRemoteServiceï¼‰
```

- ç²‰ä¸ä¸èƒ½ç›´æ¥è”ç³»æ˜æ˜Ÿ
- å¿…é¡»é€šè¿‡ç»çºªäºº
- ç»çºªäººä»£ç†äº†æ˜æ˜Ÿ

### ç±»æ¯”2ï¼šå¾‹å¸ˆ

```
ä½ ï¼ˆMainActivityï¼‰
  â†“ æ‰“å®˜å¸
å¾‹å¸ˆï¼ˆMyAidlProxyï¼‰
  â†“ ä»£ç†å‡ºåº­
æ³•åº­ï¼ˆRemoteServiceï¼‰
```

- ä½ ä¸èƒ½ç›´æ¥å‡ºåº­
- å¾‹å¸ˆä»£è¡¨ä½ 
- å¾‹å¸ˆä»£ç†äº†ä½ 

### ç±»æ¯”3ï¼šç¿»è¯‘

```
ä¸­å›½äººï¼ˆMainActivityï¼‰
  â†“ è¯´ä¸­æ–‡
ç¿»è¯‘ï¼ˆMyAidlProxyï¼‰
  â†“ ç¿»è¯‘æˆè‹±æ–‡
ç¾å›½äººï¼ˆRemoteServiceï¼‰
```

- ä¸¤ä¸ªäººè¯­è¨€ä¸é€šï¼ˆä¸åŒè¿›ç¨‹ï¼‰
- ç¿»è¯‘åœ¨ä¸­é—´ä¼ è¯ï¼ˆä»£ç†ï¼‰
- ç¿»è¯‘ä»£ç†äº†ç¾å›½äºº

---

## ğŸ¯ éªŒè¯ä»£ç†å…³ç³»

### ä»£ç éªŒè¯

```java
// åœ¨ MainActivity ä¸­æ·»åŠ è¿™æ®µä»£ç 
private ServiceConnection mConnection = new ServiceConnection() {
    @Override
    public void onServiceConnected(ComponentName name, IBinder service) {
        mService = MyAidlStub.asInterface(service);
        
        // éªŒè¯ï¼šmService åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ
        Log.d(TAG, "mService çš„çœŸå®ç±»å‹: " + mService.getClass().getName());
        // è¾“å‡º: com.zhongmin.aidl.MyAidlProxy
        
        // éªŒè¯ï¼šmService æ˜¯ä»£ç†å—ï¼Ÿ
        if (mService instanceof MyAidlProxy) {
            Log.d(TAG, "æ˜¯çš„ï¼ŒmService æ˜¯ MyAidlProxyï¼ˆä»£ç†å¯¹è±¡ï¼‰");
        }
    }
};
```

---

## ğŸ“ ç†è§£è¦ç‚¹

1. **MyAidlProxy ä»£ç†äº† RemoteService**
   - RemoteService æ˜¯çœŸå®å¯¹è±¡ï¼ˆå¹²æ´»çš„ï¼‰
   - MyAidlProxy æ˜¯ä»£ç†å¯¹è±¡ï¼ˆä¼ è¯çš„ï¼‰

2. **MainActivity ä¸çŸ¥é“ä»£ç†çš„å­˜åœ¨**
   - å®ƒä»¥ä¸ºåœ¨ç›´æ¥è°ƒç”¨ RemoteService
   - å®é™…ä¸Šè°ƒç”¨çš„æ˜¯ MyAidlProxy

3. **ä»£ç†çš„ä½œç”¨**
   - éšè—è·¨è¿›ç¨‹é€šä¿¡çš„å¤æ‚æ€§
   - è®©è¿œç¨‹è°ƒç”¨åƒæœ¬åœ°è°ƒç”¨ä¸€æ ·ç®€å•

4. **ä¸ºä»€ä¹ˆéœ€è¦ä»£ç†ï¼Ÿ**
   - ä¸åŒè¿›ç¨‹æ— æ³•ç›´æ¥è°ƒç”¨
   - Binder é€šä¿¡éœ€è¦åºåˆ—åŒ–/ååºåˆ—åŒ–
   - ä»£ç†å°è£…äº†è¿™äº›å¤æ‚æ“ä½œ

---

å¸Œæœ›ç°åœ¨ä½ æ˜ç™½äº†ï¼š"**MyAidlProxy ä»£ç†äº† RemoteService**"ï¼
